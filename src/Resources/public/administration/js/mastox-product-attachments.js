(this.webpackJsonp=this.webpackJsonp||[]).push([["mastox-product-attachments"],{"5kPv":function(t,e){Shopware.Component.override("sw-product-detail",{computed:{productCriteria(){const t=this.$super("productCriteria");return t.addAssociation("attachments"),t}}})},EFw2:function(t,e,a){"use strict";a.r(e);a("5kPv");var o=a("yBZl"),n=a.n(o);const i=Shopware.Data.Criteria;Shopware.Component.override("sw-product-detail-base",{template:n.a,data:()=>({attachmentCollection:[],mediaModalOpen:!1,defaultFolderName:"product_attachments",defaultMediaFolderId:"1e1b5ef0963d4d54a1ebdca996af9df0"}),watch:{product(){this.product.id&&this.getProductAttachments(this.product.id)}},computed:{attachmentRepository(){return this.repositoryFactory.create("mtx_product_attachments")}},methods:{getProductAttachments(t){const e=new i;e.addFilter(i.equals("productId",t)),e.setPage(this.page),e.setLimit(this.limit),e.setTotalCountMode(1),this.attachmentRepository.search(e,Shopware.Context.api).then(t=>{this.attachmentCollection=t.map(t=>t)})},createdComponent(){this.$super("createdComponent"),this.$parent.$on("media-drop",this.onItemDrop)},successfulUploadAttachment(t){const e=this.attachmentRepository.create(this.context);e.mediaId=t.id,e.productId=this.product.id,e.createAt=new Date,this.attachmentRepository.save(e,Shopware.Context.api).then(()=>{this.attachmentCollection.push(e)})},onRemoveItem(t,e){this.attachmentRepository.delete(this.attachmentCollection[e].id,Shopware.Context.api).then(()=>{this.getProductAttachments(this.product.id)})},onMediaSelectionChange(t){t.forEach(t=>{const e=this.attachmentRepository.create(this.context);e.mediaId=t.id,e.productId=this.product.id,e.createAt=new Date,this.attachmentRepository.save(e,Shopware.Context.api).then(()=>{this.attachmentCollection.push(e)})})},onOpenMediaModal(){this.mediaModalOpen=!0},onCloseMediaModal(){this.mediaModalOpen=!1}}})},yBZl:function(t,e){t.exports='{% block sw_product_detail_base_media_card %}\n    {% parent %}\n    <sw-card :isLoading="isLoading" title="Attachments">\n        <sw-media-list-selection-v2\n            :entityMediaItems="attachmentCollection"\n            :entity="attachmentRepository"\n            uploadTag="attachment"\n            @open-sidebar="onOpenMediaModal"\n            @upload-finish="successfulUploadAttachment"\n            :defaultFolderName="defaultFolderName"\n            @item-remove="onRemoveItem"\n        >\n        </sw-media-list-selection-v2>\n\n        <sw-media-modal-v2\n            variant="regular"\n            :allowMultiSelect="true"\n            :initialFolderId="defaultMediaFolderId"\n            v-if="mediaModalOpen"\n            @media-upload-remove-image="onRemoveItem"\n            @media-modal-selection-change="onMediaSelectionChange"\n            @modal-close="onCloseMediaModal">\n        </sw-media-modal-v2>\n\n    </sw-card>\n{% endblock %}\n'}},[["EFw2","runtime"]]]);